This is a monorepo generated by the agentcore create --template production CLI tool!

# Production Ready Checklist

Before using your generated project in a production environment, consult the following checklist:

- [ ] **Security:** Ensure secrets and API keys are properly handled. AgentCore Identity or AWS Secrets Manager are secure managed solutions.
- [ ] **Build Environment:** Confirm Docker builds are being executed in the desired environment. This template uses local Docker builds by default. Consider AWS CodeBuild.
- [ ] **Observability:** After deploying, [enable AgentCore observability](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/observability-configure.html#observability-configure-builtin) to allow OpenTelemetry span data to be published to AWS CloudWatch.
- [ ] **CI/CD:** Build your new project into a CI/CD pipeline to achieve automated builds, rollbacks, and multiple deployment environments. Consider AWS CodePipeline.
- [ ] **Access Control:** Configure access for clients to call into your AgentCore Runtime. Take advantage of the multiple endpoints (DEFAULT, PROD, DEV) created by this template.
- [ ] **Testing** Write unit tests in the generated `test/` directory. Implement E2E tests for further coverage.
- [ ] **Error Handling** Implement graceful and consistent error handling logic throughout your code.

# Layout

There are three main directories created in this project: `src`, `mcp`, and `cdk`. In a monorepo setup all of the code—source, test, and IaC for deployment—is contained in one repository. Everything needed to
define runtime code and deploy it into your AWS account is contained in this project.

The `cdk` directory models all of the Bedrock AgentCore and related resources. There are direct references between `cdk` and the runtime `src/`. For example, the IaC code expects to find the
Dockerfile at a specific relative path.

## src/

The `src/` directory is where you will find the runtime code.

Start with main entrypoint to the generated app, `src/main.py`. This file defines an agent using Strands and defines an entrypoint method with the Bedrock AgentCore SDK:

```
@app.entrypoint
def invoke(payload):
    # assume payload input is structured as { "prompt": "<user input>" }
```

Next there is the `src/mcp_client` directory. Here you will find `client.py`. This file defines an MCP client from the chosen Strands library. That client points to the
gateway URL for the AgentCore gateway that is modeled in the `cdk` directory. Behind that gateway is a custom MCP tool modeled as a Lambda function (see below `mcp/` section for more details).
The authorizer for the gateway is a Cognito app client that is modeled in the `cdk` directory. A call using
the client_credentials flow is defined in `_get_access_token()`.

## mcp/

The `mcp/` directory defines a simple Python tool that meets the MCP specification called `placeholder_tool`. The specification for the tool's inputs is defined in the inline schema in the modeled
`cdk` directory. When replacing the dummy implementation in `mcp/lambda/handler.py`, make sure to update the corresponding Lambda target schema to reflect the changes before re-deploying.
The `placeholder_tool` implementation demonstrates the tool name and input payload conventions of a Lambda behind the gateway. The gateway supports [flexible target types](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/gateway-add-target-api.html).

## cdk/

This directory contains a CDK project that models AgentCore and related AWS resources.

First check that Node version is >= 18:
- `node -v` → example output: `v18.19.0`
- [nvm](https://github.com/nvm-sh/nvm) is a helpful tool to manage Node versions

Make sure you have AWS credentials with sufficient permissions in your environment.

To deploy your project:

- shorthand: `cd cdk && npm install && npm run cdk synth && npm run cdk:deploy`
- navigate to the `cdk` directory: `cd cdk`
- install dependencies: `npm install`
- synth the CDK project: `npm run cdk synth`
- deploy all stacks: `npm run cdk:deploy`

# `agentcore create` output

Primarily, `agentcore create` outputs the directory that this `README.md` file is contained in. Nothing is deployed into AWS automatically.
Execute the appropriate deployment commands in the `cdk` directory to deploy.

There is also a `.bedrock_agentcore.yaml` file output in the `temp` directory. This file contains a minimal definition with your agent name when it is created. After deploying the project, when running
`agentcore invoke` or `agentcore status`, the command updates `.bedrock_agentcore.yaml` with the ID and ARN of your runtime so the CLI can successfully call the runtime using boto3.

# Invoking the deployed Runtime

The two easiest ways to invoke your runtime after deploying:

1. `agentcore invoke`
   Example:
   ```
   agentcore invoke '{"prompt": "what can you do?"}'
   ```

2. Navigate to the “Test Console” page in the Bedrock AgentCore AWS console. Select your runtime and the `DEFAULT` version. Provide an input.
   Example:
   ```
   {"prompt": "what can you do?"}
   ```
